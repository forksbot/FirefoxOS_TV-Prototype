{"version":3,"sources":["../../app/scripts/home.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;AAMb,AAAC,CAAA,UAAS,OAAO,EAAE;;AAEjB,MAAM,cAAc,GAAG,GAAG,IAAI,MAAM,CAAC,gBAAgB,IAAI,CAAC,CAAA,AAAC,CAAC;AAC5D,MAAM,YAAY,GAAG,0CAA0C,CAAC;AAChE,MAAM,eAAe,GAAG,oBAAoB,CAAC;AAC7C,MAAM,qBAAqB,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;AAC7C,MAAM,oBAAoB,GAAG,GAAG,CAAC;;;;;;AAMjC,WAAS,IAAI,GAAG,EAAE;;AAElB,MAAI,CAAC,SAAS,2BAAG;AACf,gBAAY,EACR,CAAC,eAAe,EAAE,cAAc,EAAE,aAAa,EAAE,iBAAiB,EAC9D,kBAAkB,CAAC;;AAE3B,iBAAa,EAAE,CAAC,eAAe,EAAE,cAAc,EAAE,aAAa,EACtD,iBAAiB,CAAC;;AAE1B,oBAAgB,EAAE,CAAC,kBAAkB,EAAE,mBAAmB,EACtD,kBAAkB,EAAE,sBAAsB,EAAE,mBAAmB,EAC/D,uBAAuB,CAAC;;AAE5B,eAAW,EAAE,IAAI;AACjB,oBAAgB,EAAE,CAAC,YAAY,EAAE,gBAAgB,CAAC;AAClD,uBAAmB,EAAE,EAAE;AACvB,kBAAc,EAAE,SAAS;AACzB,oBAAgB,EAAE,SAAS;AAC3B,UAAM,EAAE,SAAS;AACjB,oBAAgB,EAAE,SAAS;AAC3B,eAAW,EAAE,SAAS;;AAEtB,oBAAgB,EAAE,CAAC,mBAAmB,EAAE,kBAAkB,EACtD,sBAAsB,EAAE,mBAAmB,EAAE,uBAAuB,CAAC;;AAEzE,iBAAa,EAAE,SAAS;AACxB,gBAAY,EAAE,QAAQ,CAAC,cAAc,CAAC,WAAW,CAAC;AAClD,kBAAc,EAAE,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC;AACtD,eAAW,EAAE,SAAS;AACtB,cAAU,EAAE,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC;AAClD,kBAAc,EAAE,QAAQ,CAAC,cAAc,CAAC,iBAAiB,CAAC;AAC1D,gBAAY,EAAE,QAAQ,CAAC,cAAc,CAAC,eAAe,CAAC;AACtD,YAAQ,EAAE,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC;;AAGzC,QAAI,EAAE,gBAAW;AACf,UAAI,IAAI,GAAG,IAAI,CAAC;;AAEhB,UAAI,CAAC,SAAS,EAAE,CAAC;;AAEjB,UAAI,CAAC,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC;AACrC,UAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;;AAExB,UAAI,CAAC,SAAS,GAAG,IAAI,SAAS,EAAE,CAAC;AACjC,UAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,CAAC;AAC3D,UAAI,CAAC,SAAS,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AAC7D,UAAI,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAE/D,UAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,UAAS,QAAQ,EAAE;AACrD,YAAI,CAAC,cAAc,GAAG,IAAI,cAAc,EAAE,CAAC;AAC3C,YAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;AAE/B,YAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;AAC/B,YAAI,CAAC,cAAc,GAAG,IAAI,WAAW,CAAC;AAC9B,mBAAS,EAAE,iBAAiB;AAC5B,kBAAQ,EAAE,WAAW;AACrB,uBAAa,EAAE,YAAY;AAC3B,oBAAU,EAAE,oBAAoB,EAAC,CAAC,CAAC;;AAE3C,YAAI,CAAC,gBAAgB,GAAG,IAAI,WAAW,CAAC;AAChC,mBAAS,EAAE,mBAAmB;AAC9B,kBAAQ,EAAE,aAAa;AACvB,uBAAa,EAAE,YAAY;AAC3B,oBAAU,EAAE,oBAAoB;AAChC,eAAK,EAAE,IAAI;AACX,0BAAgB,EAAE,IAAI,CAAC,cAAc,EAAC,CAAC,CAAC;;AAEhD,YAAI,CAAC,mBAAmB,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;AACxE,YAAI,UAAU,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;;AAE7C,YAAI,CAAC,gBAAgB,GAAG,IAAI,gBAAgB,CAAC,UAAU,CAAC,CAAC;AACzD,YAAI,CAAC,gBAAgB,CAAC,YAAY,GAAG,IAAI,CAAC;AAC1C,YAAI,CAAC,mBAAmB,GAAG,IAAI,oBAAoB,EAAE,CAAC;AACtD,YAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC;AAChC,YAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;;AAG5D,YAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAEpE,YAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,eAAe,EACpB,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAErE,YAAI,CAAC,WAAW,CAAC,EAAE,CAAC,eAAe,EACjB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;AACvE,YAAI,CAAC,WAAW,CAAC,EAAE,CAAC,cAAc,EAChB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;AACtE,YAAI,CAAC,WAAW,CAAC,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAEnE,YAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AAC/D,YAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AACnE,YAAI,oBAAoB,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC3D,YAAI,sBAAsB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC/D,YAAI,sBAAsB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;AAE/D,YAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,UAAS,UAAU,EAAE;AACpD,oBAAU,CAAC,EAAE,CAAC,OAAO,EAAE,oBAAoB,CAAC,CAAC;AAC7C,oBAAU,CAAC,EAAE,CAAC,SAAS,EAAE,sBAAsB,CAAC,CAAC;AACjD,oBAAU,CAAC,EAAE,CAAC,SAAS,EAAE,sBAAsB,CAAC,CAAC;AACjD,cAAI,UAAU,CAAC,OAAO,EAAE,EAAE;AACxB,gBAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;WAC1C;SACF,CAAC,CAAC;;AAEH,YAAI,CAAC,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;AACvB,YAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,WAAW,EACvC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;AAC3D,YAAI,CAAC,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAEvD,YAAI,CAAC,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;AACzC,YAAI,CAAC,aAAa,CAAC,IAAI,CAAC;AACtB,sBAAY,EAAE,IAAI,CAAC,YAAY;AAC/B,wBAAc,EAAE,IAAI,CAAC,cAAc;AACnC,cAAI,EAAE,IAAI;AACV,qBAAW,EAAE,IAAI,CAAC,WAAW;SAC9B,CAAC,CAAC;;;;;;;AAOH,YAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAA,YAAW;AACrD,cAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;;;AAGtB,cAAI,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;SAC3C,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;;AAGd,YAAI,CAAC,SAAS,GAAG,IAAI,CAAC;AACtB,gBAAQ,CAAC,gBAAgB,CACjB,kBAAkB,EAAE,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;;AAGhE,YAAI,QAAQ,CAAC,eAAe,KAAK,SAAS,EAAE;AAC1C,cAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;;AAED,gBAAQ,CAAC,OAAO,CAAC,UAAS,IAAI,EAAE;AAC9B,cAAI,IAAI,YAAY,MAAM,EAAE;AAC1B,gBAAI,CAAC,EAAE,CAAC,eAAe,EACX,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;AACnE,gBAAI,CAAC,EAAE,CAAC,cAAc,EACV,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;WACnE;SACF,CAAC,CAAC;;AAEH,YAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;OAClD,CAAC,CAAC;KACJ;;AAED,sBAAkB,EAAE,8BAAW;AAC7B,UAAI,QAAQ,CAAC,eAAe,KAAK,SAAS,EAAE;AAC1C,aAAK,CAAC,qBAAqB,EAAE,CAAC;AAC9B,YAAI,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AAC7C,YAAI,IAAI,GAAG,IAAI,CAAC;AAChB,eAAO,CAAC,GAAG,CAAC,CAAC,IAAI,OAAO,CAAC,UAAS,OAAO,EAAE;AACzC,cAAI,CAAC,UAAU,GAAG,UAAU,CAAC,iBAAiB,CACxB,IAAI,CAAC,YAAY,EAAE,aAAa,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;SAEvE,CAAC,EAAE,IAAI,OAAO,CAAC,UAAS,OAAO,EAAE;AAChC,cAAI,IAAI,CAAC,WAAW,EAAE;AACpB,gBAAI,CAAC,gBAAgB,GAAG,UAAU,CAAC,iBAAiB,CAClC,IAAI,CAAC,cAAc,EAAE,aAAa,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;WACrE,MAAM;AACL,mBAAO,EAAE,CAAC;WACX;SAEF,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,YAAW;;;AAGnB,cAAI,CAAC,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,EAAE;AACzC,gBAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;WAC/B;AACD,cAAI,CAAC,WAAW,GAAG,IAAI,CAAC;AACxB,cAAI,CAAC,UAAU,GAAG,IAAI,CAAC;AACvB,cAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;SAC9B,CAAC,CAAC;OACJ,MAAM;AACL,YAAI,CAAC,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AAC1C,YAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;AACnC,YAAI,CAAC,WAAW,GAAG,KAAK,CAAC;;;;;;AAMzB,YAAI,IAAI,CAAC,UAAU,EAAE;AACnB,cAAI,CAAC,UAAU,EAAE,CAAC;SACnB;AACD,YAAI,IAAI,CAAC,gBAAgB,EAAE;AACzB,cAAI,CAAC,gBAAgB,EAAE,CAAC;SACzB;AACD,YAAI,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE;AACjC,cAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC;SAChC;AACD,YAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;OAClC;KACF;;AAED,aAAS,EAAE,qBAAW;AACpB,UAAI,IAAI,GAAG,IAAI,CAAC;AAChB,eAAS,CAAC,OAAO,CAAC,KAAK,CAAC,YAAW;AACjC,YAAI,CAAC,KAAK,GAAG,IAAI,KAAK,EAAE,CAAC;AACzB,YAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAE9C,cAAM,CAAC,gBAAgB,CAAC,eAAe,EACf,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAEtD,cAAM,CAAC,gBAAgB,CAAC,kBAAkB,EAClB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;OACvD,CAAC,CAAC;KACJ;;AAED,qBAAiB,EAAE,2BAAS,IAAI,EAAE,IAAI,EAAE;AACtC,UAAI,CAAC,IAAI,IAAI,CAAC,IAAI,EAAE;AAClB,eAAO;OACR;;;;AAID,UAAI,IAAI,GAAG,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC;AACzC,UAAI,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;AACxD,UAAI,IAAI,IAAI,IAAI,CAAC,GAAG,EAAE;AACpB,YAAI,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC;AACrC,YAAI,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC;OAC7B,MAAM,IAAI,IAAI,IAAI,IAAI,CAAC,EAAE,EAAE;AAC1B,mBAAW,CAAC,eAAe,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;OACzC;KACF;;AAED,kBAAc,EAAE,wBAAS,UAAU,EAAE,IAAI,EAAE,GAAG,EAAE,UAAU,EAAE;AAC1D,UAAI,IAAI,YAAY,MAAM,EAAE;AAC1B,YAAI,CAAC,EAAE,CAAC,eAAe,EACf,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;AAC/D,YAAI,CAAC,EAAE,CAAC,cAAc,EACd,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;OAC/D;;AAED,UAAI,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;AAC5C,UAAI,iBAAiB,GAAG,WAAW,CAAC,iBAAiB,CAAC;;AAEtD,uBAAiB,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;AAC5C,uBAAiB,CAAC,SAAS,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;AACvD,uBAAiB,CAAC,gBAAgB,CAAC,eAAe,EAAE,SAAS,QAAQ,GAAG;AACtE,yBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC;AAC1D,yBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;AAChD,yBAAiB,CAAC,mBAAmB,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;OAClE,CAAC,CAAC;;AAEH,UAAI,CAAC,WAAW,GAAG,KAAK,CAAC;AACzB,gBAAU,CAAC,EAAE,CAAC,UAAU,EAAE,CAAA,YAAW;AACnC,yBAAiB,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;AAC/C,YAAI,UAAU,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,KACrC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;AAC/B,2BAAiB,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;SAC9C;AACD,YAAI,CAAC,WAAW,GAAG,IAAI,CAAC;OACzB,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AACd,UAAI,CAAC,UAAU,EAAE;AACf,kBAAU,CAAC,gBAAgB,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC;OAC/C,MAAM;AACL,kBAAU,CAAC,cAAc,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC;OAC7C;KACF;;AAED,iBAAa,EAAE,uBAAS,IAAI,EAAE,GAAG,EAAE;AACjC,UAAI,IAAI,GAAG,IAAI,CAAC;AAChB,UAAI,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,eAAe,CACZ,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;AAC1E,UAAI,KAAK,GACJ,WAAW,CAAC,eAAe,CAAC,UAAU,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC;AAC1E,WAAK,CAAC,OAAO,CAAC,UAAS,IAAI,EAAE;AAC3B,YAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;AACnC,cAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SACpC;OACF,CAAC,CAAC;KACJ;;AAED,iBAAa,EAAE,uBAAS,UAAU,EAAE,OAAO,EAAE;AAC3C,aAAO,CAAC,OAAO,CAAC,UAAS,GAAG,EAAE;AAC5B,YAAI,GAAG,GAAG,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;AAClC,YAAI,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,YAAY,EAAE;AACnC,aAAG,CAAC,eAAe,CAAC,GAAG,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;SAC/C;OACF,EAAE,IAAI,CAAC,CAAC;AACT,gBAAU,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;KACjC;;AAED,gBAAY,EAAE,sBAAU,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE;AACtD,UAAI;AACH,YAAI,KAAK,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;AACtC,YAAI,OAAO,EAAE;AACX,oBAAU,CAAC,KAAK,CAAC,eAAe,GAAG,OAAO,CAAC;AAC3C,oBAAU,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AACnC,cAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;SAChC,MAAM;AACL,oBAAU,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;AACtC,cAAI,CAAC,cAAc,GAAG,WAAW,CAAC;SACnC;AACD,kBAAU,CAAC,OAAO,CAAC,YAAY,GAAG,KAAK,CAAC;AACxC,kBAAU,CAAC,KAAK,CAAC,eAAe,GAAG,OAAO,GAAG,KAAK,GAAG,IAAI,CAAC;OAC3D,CAAC,OAAO,CAAC,EAAE;;;AAGV,kBAAU,CAAC,KAAK,CAAC,eAAe,GAAG,YAAY,CAAC;AAChD,kBAAU,CAAC,KAAK,CAAC,eAAe,GAAG,eAAe,CAAC;OACpD;KACF;;AAED,eAAW,EAAE,qBAAS,UAAU,EAAE,IAAI,EAAE;;;AAGtC,UAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAC9C,cAAQ,CAAC,SAAS,GAAG,MAAM,CAAC;AAC5B,cAAQ,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;;;AAGvC,UAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAC9C,eAAS,CAAC,SAAS,GAAG,WAAW,CAAC;AAClC,eAAS,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;AACtC,eAAS,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,aAAa,CAAC,CAAC;AACxD,eAAS,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;;;AAGvC,UAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAC7C,cAAQ,CAAC,SAAS,GAAG,WAAW,CAAC;AACjC,cAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;AACpC,cAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC,CAAC;;AAEtD,gBAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;AACjC,gBAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;AACjC,gBAAU,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;AAClC,gBAAU,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;KACpD;;AAED,iBAAa,EAAE,uBAAS,UAAU,EAAE,IAAI,EAAE;AACxC,UAAI,WAAW,GAAG,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;AAC/D,UAAI,IAAI,GAAG,IAAI,CAAC;;AAEhB,UAAI,IAAI,CAAC,SAAS,EAAE;AAClB,YAAI,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,EAChC,IAAI,CAAC,eAAe,CAAC,CAAC;;OAEzC,MAAM,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;;AAE/B,cAAI,CAAC,WAAW,CAAC,WAAW,CAAC;AAC3B,uBAAW,EAAE,WAAW;AACxB,sBAAU,EAAE,IAAI,CAAC,UAAU;;;AAG3B,yBAAa,EAAE,cAAc;WAC9B,CAAC,CAAC,IAAI,CAAC,UAAS,QAAQ,EAAE;AACzB,gBAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;AACvB,gBAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;AACvB,gBAAI,IAAI,IAAI,cAAc,EAAE;AAC1B,kBAAI,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;aACjD,MAAM;AACL,kBAAI,CAAC,aAAa,CAAC,IAAI,EAAE,UAAS,KAAK,EAAE,GAAG,EAAE;AAC5C,oBAAI,GAAG,EAAE;AACP,sBAAI,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE,eAAe,CAAC,CAAC;iBAC5D,MAAM;AACL,sBAAI,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,GAAG,KAAK,CAAC,CAAC,CAAC,GAC1D,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;iBAC9D;eACF,CAAC,CAAC;aACJ;AACD,gBAAI,CAAC,cAAc,GAAG,IAAI,CAAC;WAC5B,CAAC,CAAC;SACJ,MAAM,IAAI,IAAI,CAAC,cAAc,EAAE;;AAE9B,cAAI,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,EACrC,IAAI,CAAC,eAAe,CAAC,CAAC;SACzC;KACF;;AAED,iBAAa,EAAE,uBAAS,IAAI,EAAE,QAAQ,EAAE;AACtC,UAAI,EAAE,GAAG,CAAC,CAAC;AACX,eAAS,UAAU,CAAC,KAAK,EAAE,GAAG,EAAE;AAC9B,YAAI,GAAG,EAAE;AACP,kBAAQ,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;SACrB,MAAM,IAAI,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,IAAI,EAAE,GAAG,GAAG,EAAE;AACrC,YAAE,IAAI,IAAI,CAAC;AACX,qBAAW,CAAC,aAAa,CAAC,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;SACtD,MAAM;AACL,kBAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,qBAAqB,GAAG,KAAK,EAAE,GAAG,CAAC,CAAC;SAC/D;OACF;;AAED,iBAAW,CAAC,aAAa,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,UAAU,CAAC,CAAC;KACrD;;AAED,iBAAa,EAAE,yBAAW;AACxB,UAAI,IAAI,CAAC,gBAAgB,KAAK,IAAI,CAAC,gBAAgB,EAAE;AACnD,YAAI,CAAC,qBAAqB,EAAE,CAAC;OAC9B;KACF;;AAED,kBAAc,EAAE,wBAAS,IAAI,EAAE;;;;;;;;;;AAU7B,UAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAC7C,cAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;;AAE/B,UAAI,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;AACxD,gBAAU,CAAC,YAAY,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;AAC9C,gBAAU,CAAC,SAAS,GAAG,YAAY,CAAC;AACpC,gBAAU,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;;AAExC,UAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;AAClD,eAAS,CAAC,SAAS,GAAG,YAAY,CAAC;;AAEnC,UAAI,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;AAC1D,kBAAY,CAAC,OAAO,CAAC,IAAI,GAAG,QAAQ,CAAC;AACrC,kBAAY,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;;AAEzC,UAAI,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;AAC1D,kBAAY,CAAC,OAAO,CAAC,IAAI,GAAG,QAAQ,CAAC;AACrC,kBAAY,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;;AAEzC,eAAS,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;AACpC,eAAS,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;;AAEpC,cAAQ,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;AACjC,cAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;;;;AAIhC,UAAI,IAAI,YAAY,WAAW,EAAE;AAC/B,YAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAE;AACvB,oBAAU,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;AACvC,oBAAU,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;AAC/B,oBAAU,CAAC,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;SAC3C,MAAM;AACL,oBAAU,CAAC,YAAY,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;AAC3C,cAAI,CAAC,aAAa,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;SACtC;OACF,MAAM,IAAI,IAAI,YAAY,IAAI,EAAE;AAC/B,kBAAU,CAAC,YAAY,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;AAC5C,YAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;AAC5B,cAAI,CAAC,aAAa,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;SACtC,MAAM;AACL,cAAI,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;SACpC;OACF,MAAM,IAAI,IAAI,YAAY,MAAM,EAAE;AACjC,kBAAU,CAAC,YAAY,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;AAC9C,kBAAU,CAAC,OAAO,CAAC,IAAI,GAAG,QAAQ,CAAC;OACpC;;;;;;;AAOD,UAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAC9C,cAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AAC/B,UAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;AACvC,gBAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;;AAEjC,aAAO,QAAQ,CAAC;KACjB;;AAED,mBAAe,EAAE,yBAAS,QAAQ,EAAE;AAClC,cAAQ,CAAC,OAAO,CAAC,CAAA,UAAS,IAAI,EAAE;AAC9B,YAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC;OAC1D,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KACf;;AAED,UAAM,EAAE,gBAAS,GAAG,EAAE;AACpB,UAAI,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE;AAC9C,eAAO;OACR;;AAED,UAAI,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,CAAC;;AAEtD,UAAI,EAAE,KAAK,CAAC,UAAU,IAAI,aAAa,IAAI,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA,AAAC,EAAE;AAC3D,YAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;OACjC;KACF;;AAED,WAAO,EAAE,mBAAW;AAClB,UAAI,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE;AAC5C,eAAO;OACR;;AAED,UAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;;AAE/B,UAAI,SAAS,KAAK,IAAI,CAAC,cAAc,EAAE;AACrC,YAAI,CAAC,YAAY,EAAE,CAAC;OACrB,MAAM,IAAI,SAAS,KAAK,IAAI,CAAC,UAAU,EAAE;AACxC,YAAI,CAAC,qBAAqB,EAAE,CAAC;AAC7B,YAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;;AAE3B,YAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;OAClC,MAAM,IAAI,SAAS,IAChB,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE;AACpD,YAAI,CAAC,qBAAqB,EAAE,CAAC;OAC9B,MAAM;;AAEL,YAAI,MAAM,GAAG,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC;AACtC,YAAI,IAAI,CAAC;AACT,YAAI,IAAI,CAAC,eAAe,KAAK,IAAI,CAAC,gBAAgB,EAAE;AAClD,cAAI,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAC,MAAM,EAAE,MAAM,EAAC,CAAC,CAAC;SACpD,MAAM;AACL,cAAI,GAAG,IAAI,CAAC,WAAW,CAAC,oBAAoB,CAAC,EAAC,MAAM,EAAE,MAAM,EAAC,CAAC,CAAC;SAChE;;AAED,YAAI,IAAI,EAAE;AACR,cAAI,CAAC,MAAM,EAAE,CAAC;SACf;OACF;KACF;;AAED,oBAAgB,EAAE,4BAAW;AAC3B,UAAI,aAAa,GAAG,CAAA,YAAW;AAC7B,gBAAQ,CAAC,mBAAmB,CAAC,kBAAkB,EAAE,aAAa,CAAC,CAAC;AAChE,YAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;OACvB,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACb,cAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,aAAa,CAAC,CAAC;;AAE7D,UAAI,QAAQ,GAAG,IAAI,WAAW,CAAC;AAC7B,YAAI,EAAE,QAAQ;AACd,YAAI,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE;OACtB,CAAC,CAAC;;AAEH,cAAQ,CAAC,OAAO,GAAG,aAAa,CAAC;KAClC;;AAED,qBAAiB,EAAE,6BAAW;AAC5B,UAAI,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;KAC9C;;AAED,wBAAoB,EAAE,gCAAW;AAC/B,UAAI,QAAQ,GAAG,EAAE,CAAC;AAClB,UAAI,CAAC,YAAY,CAAC,OAAO,CAAC,UAAS,EAAE,EAAE;AACrC,YAAI,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;AACvC,YAAI,IAAI,EAAE;AACR,kBAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACrB;OACF,CAAC,CAAC;AACH,UAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAS,SAAS,EAAE;AAChD,YAAI,KAAK,GAAG,QAAQ,CAAC,sBAAsB,CAAC,SAAS,CAAC,CAAC;AACvD,YAAI,KAAK,CAAC,MAAM,EAAE;;AAEhB,kBAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;SAC/D;OACF,CAAC,CAAC;AACH,cAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;AACrD,aAAO,QAAQ,CAAC;KACjB;;AAED,eAAW,EAAE,qBAAS,IAAI,EAAE;AAC1B,UAAI,IAAI,CAAC,UAAU,IAAI,aAAa,EAAE;AACpC,YAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;AAC7B,YAAI,CAAC,KAAK,EAAE,CAAC;AACb,YAAI,CAAC,iBAAiB,EAAE,CAAC;OAC1B,MAAM,IAAI,IAAI,CAAC,QAAQ,EAAE;AACxB,YAAI,IAAI,CAAC,MAAM,EAAE;AACf,cAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;SACpB;;AAED,gBAAO,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE;AAChC,eAAK,YAAY;AACf,gBAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;AAChC,kBAAM;AAAA,AACR;AACE,gBAAI,CAAC,KAAK,EAAE,CAAC;AACb,gBAAI,CAAC,MAAM,GAAG,IAAI,CAAC;AACnB,gBAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;AAClC,gBAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;AAC7B,kBAAM;AAAA,SACT;OACF,MAAM;AACL,YAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;OACnC;KACF;;AAED,iBAAa,EAAE,uBAAS,IAAI,EAAE,QAAQ,EAAE;AACtC,UAAG,IAAI,CAAC,UAAU,IAAI,aAAa,EAAE;AACnC,YAAI,CAAC,iBAAiB,CACd,IAAI,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;OACzE;KACF;;AAED,qBAAiB,EAAE,2BAAS,IAAI,EAAE;AAChC,UAAI,CAAC,IAAI,CAAC,aAAa,EAAE;AACvB,eAAO;OACR;;;AAGD,UAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;AAC/C,YAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;AAC3B,YAAI,CAAC,aAAa,GAAG,IAAI,CAAC;OAC3B;KACF;;AAED,wBAAoB,EAAE,8BAAS,SAAS,EAAE;AACxC,UAAI,IAAI,GAAG,IAAI,CAAC;AAChB,eAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,YAAW;AAClC,YAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AACxC,YAAI,YAAY,GAAG,SAAS,CAAC,iBAAiB,CAAC;AAC/C,YAAI,cAAc,GAAG,IAAI,CAAC;AAC1B,eAAM,YAAY,EAAE;AAClB,kBAAO,YAAY,CAAC,QAAQ,CAAC,WAAW,EAAE;AACxC,iBAAK,OAAO,CAAC;AACb,iBAAK,QAAQ;AACX,oBAAM;AAAA,AACR;AACE,4BAAc,GAAG,cAAc,IAAI,YAAY,CAAC;AAChD,kBAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;AAAA,WAC3C;AACD,sBAAY,GAAG,YAAY,CAAC,kBAAkB,CAAC;SAChD;AACD,YAAI,cAAc,EAAE;AAClB,cAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;SAC7C;OACF,CAAC,CAAC;AACH,eAAS,CAAC,IAAI,CAAC,YAAY,EAAE,YAAW;;;AAGtC,iBAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AACxB,YAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;AACrC,YAAI,YAAY,GAAG,SAAS,CAAC,iBAAiB,CAAC;AAC/C,eAAM,YAAY,EAAE;AAClB,kBAAO,YAAY,CAAC,QAAQ,CAAC,WAAW,EAAE;AACxC,iBAAK,OAAO,CAAC;AACb,iBAAK,QAAQ;AACX,oBAAM;AAAA,AACR;AACE,kBAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;AAAA,WAC9C;AACD,sBAAY,GAAG,YAAY,CAAC,kBAAkB,CAAC;SAChD;OACF,CAAC,CAAC;AACH,UAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;AAClC,UAAI,CAAC,aAAa,GAAG,SAAS,CAAC;AAC/B,eAAS,CAAC,IAAI,EAAE,CAAC;KAClB;;AAED,mBAAe,EAAE,yBAAS,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE;AACxD,UAAI,CAAC,MAAM,GAAG,QAAQ,CAAC;;AAEvB,UAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,MAAM,EAAE;AAC7B,YAAI,CAAC,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;OAC3D;AACD,cAAQ,CAAC,KAAK,EAAE,CAAC;AACjB,cAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;AAClC,UAAG,UAAU,KAAK,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,WAAW,IACvC,QAAQ,CAAC,OAAO,CAAC,MAAM,KAAK,IAAI,CAAC,WAAW,CAAC,MAAM,IACnD,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,EAAE;AACjD,YAAI,CAAC,qBAAqB,EAAE,CAAC;OAC9B;KACF;;AAED,yBAAqB,EAAE,+BAAS,gBAAgB,EAAE;AAChD,UAAI,IAAI,CAAC,gBAAgB,KAAK,IAAI,CAAC,gBAAgB,IAC/C,CAAC,gBAAgB,EAAE;AACrB,YAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;OAClD;AACD,UAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;AACpD,UAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;AAC9B,UAAI,CAAC,WAAW,GAAG,SAAS,CAAC;AAC7B,UAAI,CAAC,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;AAChC,UAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;KAC1C;;AAED,qBAAiB,EAAE,2BAAS,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE;;AAE1D,UAAI,QAAQ,EAAE;AACZ,gBAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;OACtC;KACF;;AAED,qBAAiB,EAAE,2BAAS,UAAU,EAAE,QAAQ,EAAE,QAAQ,EAAE;AAC1D,UAAI,CAAC,qBAAqB,EAAE,CAAC;KAC9B;;AAED,yBAAqB,EAAE,+BAAS,GAAG,EAAE;;;;AAInC,UAAI,IAAI,CAAC,eAAe,KAAK,IAAI,CAAC,cAAc,IAC9C,GAAG,CAAC,cAAc,CAAC,SAAS,CAAC,QAAQ,CAAC,YAAY,CAAC,KAClD,CAAC,IAAI,CAAC,WAAW,IAChB,IAAI,CAAC,WAAW,CAAC,MAAM,KAAK,GAAG,CAAC,cAAc,CAAC,OAAO,CAAC,MAAM,CAAA,AAAC,KAC/D,GAAG,CAAC,cAAc,CAAC,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC;;;;AAI/C,SAAG,CAAC,YAAY,KAAK,eAAe,IACpC,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,OAAO,CAAC,IAAI,KAAK,SAAS;;AAElE,SAAG,CAAC,cAAc,CAAC,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAA,AAAC,EAAE;AACrD,YAAI,CAAC,eAAe,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;OAC1C;KACF;;AAED,mBAAe,EAAE,yBAAS,MAAM,EAAE;AAChC,UAAI,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC;AACnC,UAAI,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,oBAAoB,CAAC,EAAC,MAAM,EAAE,MAAM,EAAC,CAAC,CAAC;AACnE,UAAI,EAAE,IAAI,YAAY,MAAM,CAAA,AAAC,EAAE;AAC7B,eAAO;OACR;;AAED,UAAI,CAAC,WAAW,GAAG,IAAI,CAAC;AACxB,UAAI,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;;AAEhD,UAAI,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE;AAC3B,YAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;;;AAG/B,YAAI,CAAC,cAAc,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;AAC9C,eAAO;OACR;;;AAGD,gBAAU,CAAC,OAAO,CAAC,UAAS,IAAI,EAAE;AAChC,YAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC;OAC1D,EAAE,IAAI,CAAC,CAAC;;AAET,UAAI,YAAY,GAAG,IAAI,CAAC;AACxB,UAAI,mBAAmB,GAAG,CAAA,YAAW;AACnC,YAAI,YAAY,EAAE;AAChB,sBAAY,GAAG,KAAK,CAAC;;;;AAIrB,cAAI,CAAC,cAAc,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;AAC9C,cAAI,CAAC,gBAAgB,CAAC,yBAAyB,EAAE,CAAC;AAClD,cAAI,CAAC,gBAAgB,GAAG,UAAU,CAAC,iBAAiB,CACtC,IAAI,CAAC,cAAc,EAAE,aAAa,EAAE,GAAG,EAAE,CAAA,YAAW;AAC9D,gBAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;AACjD,gBAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;AAC/B,gBAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;WACnC,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAEhB,gBAAM,CAAC,qBAAqB,CAAC,mBAAmB,CAAC,CAAC;SACnD,MAAM;;AAEL,cAAI,CAAC,cAAc,CAAC,KAAK,CAAC,UAAU,GAAG,EAAE,CAAC;SAC3C;OACF,CAAA,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACb,YAAM,CAAC,qBAAqB,CAAC,mBAAmB,CAAC,CAAC;KACnD;;AAED,gBAAY,EAAE,wBAAW;;AAEvB,UAAI,WAAW,CAAC;AACd,YAAI,EAAE,WAAW;AACjB,YAAI,EAAE,EAAE;OACT,CAAC,CAAC;KACJ;;AAED,eAAW,EAAE,uBAAW;AACtB,UAAI,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC;AACrB,UAAI,CAAC,GAAG,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC;AAC9B,UAAI,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC;;AAE3C,UAAI,CAAC,GAAG,IAAI,SAAS,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC;;AAE/C,UAAI,UAAU,GAAG,SAAS,GAAG,CAAC,CAAC,mBAAmB,CAAC,GACtB,CAAC,CAAC,mBAAmB,CAAC,CAAC;;AAEpD,gBAAU,GAAG,UAAU,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;AACjD,UAAI,SAAS,GAAG,CAAC,CAAC,YAAY,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;;AAEhD,UAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,SAAS,CAAC;AACpC,UAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,GAAG,SAAS,GAAG,CAAC,CAAC,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC;KACzE;;AAED,gBAAY,EAAE,wBAAW;AACvB,eAAS,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,YAAW;;AAElC,YAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;AAClB,YAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;OAC/C,CAAA,CAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;KAChB;;GASF;AAPK,aAAS;WAAA,eAAG;AACd,eAAO,IAAI,CAAC,MAAM,CAAC;OACpB;;;;AAEG,mBAAe;WAAA,eAAG;AACpB,eAAO,IAAI,CAAC,gBAAgB,CAAC;OAC9B;;;;IACF,CAAC;;AAEF,SAAO,CAAC,IAAI,GAAG,IAAI,CAAC;CACrB,CAAA,CAAC,MAAM,CAAC,CAAE","file":"home.js","sourcesContent":["'use strict';\n/* global Application, FilterManager, CardManager, Clock, Deck, Edit, Folder,\n          KeyNavigationAdapter, MessageHandler, MozActivity, SearchBar,\n          SharedUtils, SpatialNavigator, URL, XScrollable, Animations, Utils */\n/* jshint nonew: false */\n\n(function(exports) {\n\n  const FULLSIZED_ICON = 336 * (window.devicePixelRatio || 1);\n  const DEFAULT_ICON = 'url(\"/style/images/appic_developer.png\")';\n  const DEFAULT_BGCOLOR = 'rgba(0, 0, 0, 0.5)';\n  const DEFAULT_BGCOLOR_ARRAY = [0, 0, 0, 0.5];\n  const CARDLIST_LEFT_MARGIN = 8.4;\n\n  /**\n   * Main class of smart-home\n   * @class Home\n   */\n  function Home() {}\n\n  Home.prototype = {\n    navigableIds:\n        ['search-button', 'search-input', 'edit-button', 'settings-button',\n            'filter-tab-group'],\n\n    topElementIds: ['search-button', 'search-input', 'edit-button',\n            'settings-button'],\n\n    bottomElementIds: ['filter-tab-group', 'filter-all-button',\n        'filter-tv-button', 'filter-device-button', 'filter-app-button',\n        'filter-website-button'],\n\n    isNavigable: true,\n    navigableClasses: ['filter-tab', 'command-button'],\n    navigableScrollable: [],\n    cardScrollable: undefined,\n    folderScrollable: undefined,\n    _focus: undefined,\n    _focusScrollable: undefined,\n    _folderCard: undefined,\n\n    filterElementIds: ['filter-all-button', 'filter-tv-button',\n        'filter-device-button', 'filter-app-button', 'filter-website-button'],\n\n    filterManager: undefined,\n    cardListElem: document.getElementById('card-list'),\n    folderListElem: document.getElementById('folder-list'),\n    cardManager: undefined,\n    editButton: document.getElementById('edit-button'),\n    settingsButton: document.getElementById('settings-button'),\n    searchButton: document.getElementById('search-button'),\n    timeElem: document.getElementById('time'),\n\n\n    init: function() {\n      var that = this;\n\n      this.initClock();\n\n      this.cardManager = new CardManager();\n      this.cardManager.init();\n\n      this.searchBar = new SearchBar();\n      this.searchBar.init(document.getElementById('search-bar'));\n      this.searchBar.on('shown', this.onSearchBarShown.bind(this));\n      this.searchBar.on('hidden', this.onSearchBarHidden.bind(this));\n\n      this.cardManager.getCardList().then(function(cardList) {\n        that.messageHandler = new MessageHandler();\n        that.messageHandler.init(that);\n\n        that._createCardList(cardList);\n        that.cardScrollable = new XScrollable({\n                frameElem: 'card-list-frame',\n                listElem: 'card-list',\n                itemClassName: 'app-button',\n                leftMargin: CARDLIST_LEFT_MARGIN});\n\n        that.folderScrollable = new XScrollable({\n                frameElem: 'folder-list-frame',\n                listElem: 'folder-list',\n                itemClassName: 'app-button',\n                leftMargin: CARDLIST_LEFT_MARGIN,\n                scale: 0.68,\n                referenceElement: that.cardScrollable});\n\n        that.navigableScrollable = [that.cardScrollable, that.folderScrollable];\n        var collection = that._getNavigateElements();\n\n        that.spatialNavigator = new SpatialNavigator(collection);\n        that.spatialNavigator.straightOnly = true;\n        that.keyNavigatorAdapter = new KeyNavigationAdapter();\n        that.keyNavigatorAdapter.init();\n        that.keyNavigatorAdapter.on('move', that.onMove.bind(that));\n        // All behaviors which no need to have multple events while holding the\n        // key should use keyup.\n        that.keyNavigatorAdapter.on('enter-keyup', that.onEnter.bind(that));\n\n        that.cardListElem.addEventListener('transitionend',\n                                      that.determineFolderExpand.bind(that));\n\n        that.cardManager.on('card-inserted',\n                          that.onCardInserted.bind(that, that.cardScrollable));\n        that.cardManager.on('card-removed',\n                          that.onCardRemoved.bind(that, that.cardScrollable));\n        that.cardManager.on('card-updated', that.onCardUpdated.bind(that));\n\n        that.spatialNavigator.on('focus', that.handleFocus.bind(that));\n        that.spatialNavigator.on('unfocus', that.handleUnfocus.bind(that));\n        var handleCardFocusBound = that.handleCardFocus.bind(that);\n        var handleCardUnfocusBound = that.handleCardUnfocus.bind(that);\n        var handleCardUnhoverBound = that.handleCardUnhover.bind(that);\n\n        that.navigableScrollable.forEach(function(scrollable) {\n          scrollable.on('focus', handleCardFocusBound);\n          scrollable.on('unfocus', handleCardUnfocusBound);\n          scrollable.on('unhover', handleCardUnhoverBound);\n          if (scrollable.isEmpty()) {\n            that.spatialNavigator.remove(scrollable);\n          }\n        });\n\n        that.edit = new Edit();\n        that.edit.init(that.spatialNavigator, that.cardManager,\n                       that.cardScrollable, that.folderScrollable);\n        that.edit.on('arrange', that.onArrangeMode.bind(that));\n\n        that.filterManager = new FilterManager();\n        that.filterManager.init({\n          cardListElem: that.cardListElem,\n          cardScrollable: that.cardScrollable,\n          home: that,\n          cardManager: that.cardManager,\n        });\n\n        // In some case, we can do action at keydown which is translated as\n        // onEnter in home.js. But in button click case, we need to listen\n        // keyup. So, instead keydown/keyup, we just use click event to handle\n        // it. The click event is translated at smart-button when use press\n        // enter on smart-button.\n        that.searchButton.addEventListener('click', function() {\n          that.searchBar.show();\n          // hide the searchButton because searchBar has an element whose\n          // appearance is the same as it.\n          that.searchButton.classList.add('hidden');\n        }.bind(that));\n\n        // handle animation\n        that.endBubble = null;\n        document.addEventListener(\n                'visibilitychange', that.onVisibilityChange.bind(that));\n        // if this init function is executed after the document is set to\n        // visible, the visibilitychange event may not be triggered.\n        if (document.visibilityState === 'visible') {\n          that.onVisibilityChange();\n        }\n\n        cardList.forEach(function(card) {\n          if (card instanceof Folder) {\n            card.on('card-inserted',\n                        that.onCardInserted.bind(that, that.folderScrollable));\n            card.on('card-removed',\n                        that.onCardRemoved.bind(that, that.folderScrollable));\n          }\n        });\n\n        that.spatialNavigator.focus(that.cardScrollable);\n      });\n    },\n\n    onVisibilityChange: function() {\n      if (document.visibilityState === 'visible') {\n        Utils.holdFocusForAnimation();\n        this.cardListElem.classList.remove('hidden');\n        var that = this;\n        Promise.all([new Promise(function(resolve) {\n          that.skipBubble = Animations.doBubbleAnimation(\n                                that.cardListElem, '.app-button', 100, resolve);\n\n        }), new Promise(function(resolve) {\n          if (that._folderCard) {\n            that.skipFolderBubble = Animations.doBubbleAnimation(\n                              that.folderListElem, '.app-button', 100, resolve);\n          } else {\n            resolve();\n          }\n\n        })]).then(function() {\n          // Catch focus back unless there is a pin activity since callback of\n          // pinning would catch the focus for us.\n          if (!that.messageHandler.resumeActivity()) {\n            that.spatialNavigator.focus();\n          }\n          that.isNavigable = true;\n          that.skipBubble = null;\n          that.skipFolderBubble = null;\n        });\n      } else {\n        this.cardListElem.classList.add('hidden');\n        this.messageHandler.stopActivity();\n        this.isNavigable = false;\n        // An user may close home app when bubbling or sliding animations are\n        // still playing, and then open home app again right away. In this case,\n        // the user will see the last unfinished animations. In order to solve\n        // this, we have to force disable all the animations and trigger their\n        // callbacks when home app is in hidden state.\n        if (this.skipBubble) {\n          this.skipBubble();\n        }\n        if (this.skipFolderBubble) {\n          this.skipFolderBubble();\n        }\n        if (this.cardScrollable.isSliding) {\n          this.cardScrollable.endSlide();\n        }\n        this.filterManager.resetFilter();\n      }\n    },\n\n    initClock: function() {\n      var that = this;\n      navigator.mozL10n.ready(function() {\n        that.clock = new Clock();\n        that.clock.start(that.updateClock.bind(that));\n        // Listen to 'moztimechange'\n        window.addEventListener('moztimechange',\n                                that.restartClock.bind(that));\n        // Listen to 'timeformatchange'\n        window.addEventListener('timeformatchange',\n                                that.restartClock.bind(that));\n      });\n    },\n\n    _localizeCardName: function(elem, card) {\n      if (!elem || !card) {\n        return;\n      }\n\n      // We should use user given name first, otherwise we use localized\n      // application/deck name.\n      var lang = document.documentElement.lang;\n      var name = this.cardManager.resolveCardName(card, lang);\n      if (name && name.raw) {\n        elem.removeAttribute('data-l10n-id');\n        elem.textContent = name.raw;\n      } else if (name && name.id) {\n        SharedUtils.localizeElement(elem, name);\n      }\n    },\n\n    onCardInserted: function(scrollable, card, idx, overFolder) {\n      if (card instanceof Folder) {\n        card.on('card-inserted',\n                this.onCardInserted.bind(this, this.folderScrollable));\n        card.on('card-removed',\n                this.onCardRemoved.bind(this, this.folderScrollable));\n      }\n\n      var newCardElem = this.createCardNode(card);\n      var newCardButtonElem = newCardElem.firstElementChild;\n      // Initial transition for new card\n      newCardButtonElem.classList.add('new-card');\n      newCardButtonElem.classList.add('new-card-transition');\n      newCardButtonElem.addEventListener('transitionend', function onPinned() {\n        newCardButtonElem.classList.remove('new-card-transition');\n        newCardButtonElem.classList.remove('last-card');\n        newCardButtonElem.removeEventListener('transitionend', onPinned);\n      });\n      // insert new card into cardScrollable\n      this.isNavigable = false;\n      scrollable.on('slideEnd', function() {\n        newCardButtonElem.classList.remove('new-card');\n        if (scrollable.nodes.indexOf(newCardElem) ===\n            scrollable.nodes.length - 1) {\n          newCardButtonElem.classList.add('last-card');\n        }\n        this.isNavigable = true;\n      }.bind(this));\n      if (!overFolder) {\n        scrollable.insertNodeBefore(newCardElem, idx);\n      } else {\n        scrollable.insertNodeOver(newCardElem, idx);\n      }\n    },\n\n    onCardUpdated: function(card, idx) {\n      var that = this;\n      var cardButton = this.cardScrollable.getItemFromNode(\n                                              this.cardScrollable.getNode(idx));\n      var spans =\n           SharedUtils.nodeListToArray(cardButton.getElementsByTagName('span'));\n      spans.forEach(function(span) {\n        if (span.classList.contains('name')) {\n          that._localizeCardName(span, card);\n        }\n      });\n    },\n\n    onCardRemoved: function(scrollable, indices) {\n      indices.forEach(function(idx) {\n        var elm = scrollable.getNode(idx);\n        if (elm && elm.dataset.revokableURL) {\n          URL.revokeObjectURL(elm.dataset.revokableURL);\n        }\n      }, this);\n      scrollable.removeNodes(indices);\n    },\n\n    _setCardIcon: function (cardButton, card, blob, bgColor) {\n       try {\n        var bgUrl = URL.createObjectURL(blob);\n        if (bgColor) {\n          cardButton.style.backgroundColor = bgColor;\n          cardButton.classList.add('fitted');\n          card.backgroundType = 'fitted';\n        } else {\n          cardButton.classList.add('fullsized');\n          card.backgroundType = 'fullsized';\n        }\n        cardButton.dataset.revokableURL = bgUrl;\n        cardButton.style.backgroundImage = 'url(\"' + bgUrl + '\")';\n      } catch (e) {\n        // If the blob is broken, we may get an exception while creating object\n        // URL.\n        cardButton.style.backgroundImage = DEFAULT_ICON;\n        cardButton.style.backgroundColor = DEFAULT_BGCOLOR;\n      }\n    },\n\n    _createWave: function(cardButton, card) {\n\n      // deck's icon using gaia font\n      var deckIcon = document.createElement('span');\n      deckIcon.className = 'icon';\n      deckIcon.dataset.icon = card.deckClass;\n\n      // front wave of a deck\n      var waveFront = document.createElement('div');\n      waveFront.className = 'deck-wave';\n      waveFront.classList.add('wave-front');\n      waveFront.classList.add(card.deckClass + '-wave-front');\n      waveFront.classList.add('wave-paused');\n\n      // back wave of a deck\n      var waveBack = document.createElement('div');\n      waveBack.className = 'deck-wave';\n      waveBack.classList.add('wave-back');\n      waveBack.classList.add(card.deckClass + '-wave-back');\n\n      cardButton.appendChild(waveBack);\n      cardButton.appendChild(deckIcon);\n      cardButton.appendChild(waveFront);\n      cardButton.classList.add('deck-' + card.deckClass);\n    },\n\n    _fillCardIcon: function(cardButton, card) {\n      var manifestURL = card.nativeApp && card.nativeApp.manifestURL;\n      var that = this;\n      // We have thumbnail which is created by pin\n      if (card.thumbnail) {\n        this._setCardIcon(cardButton, card, card.thumbnail,\n                          card.backgroundColor);\n        // TODO add backgroundColor??? How to do it???\n      } else if (!card.cachedIconBlob) {\n        // We don't have cachedIconBlob, just get icon from app\n        this.cardManager.getIconBlob({\n          manifestURL: manifestURL,\n          entryPoint: card.entryPoint,\n          // XXX: preferredSize should be determined by\n          // real offsetWidth of cardThumbnailElem instead of hard-coded value\n          preferredSize: FULLSIZED_ICON\n        }).then(function(iconData) {\n          var blob = iconData[0];\n          var size = iconData[1];\n          if (size >= FULLSIZED_ICON) {\n            that._setCardIcon(cardButton, card, blob, null);\n          } else {\n            that._getIconColor(blob, function(color, err) {\n              if (err) {\n                that._setCardIcon(cardButton, card, blob, DEFAULT_BGCOLOR);\n              } else {\n                that._setCardIcon(cardButton, card, blob, 'rgba(' + color[0] +\n                  ', ' + color[1] + ', ' + color[2] + ', ' + color[3] + ')');\n              }\n            });\n          }\n          card.cachedIconBlob = blob;\n        });\n      } else if (card.cachedIconBlob) {\n        // We already have cacedIconBlob which is created by previous step.\n        this._setCardIcon(cardButton, card, card.cachedIconBlob,\n                          card.backgroundColor);\n      }\n    },\n\n    _getIconColor: function(blob, callback) {\n      var dy = 0;\n      function checkColor(color, err) {\n        if (err) {\n          callback(null, err);\n        } else if (color[3] < 255 && dy < 0.5) {\n          dy += 0.25;\n          SharedUtils.readColorCode(blob, 0.5, dy, checkColor);\n        } else {\n          callback(color[3] < 255 ? DEFAULT_BGCOLOR_ARRAY : color, err);\n        }\n      }\n\n      SharedUtils.readColorCode(blob, 0.5, 0, checkColor);\n    },\n\n    onArrangeMode: function() {\n      if (this._focusScrollable !== this.folderScrollable) {\n        this.cleanFolderScrollable();\n      }\n    },\n\n    createCardNode: function(card) {\n      // card element would be created like this:\n      // <div class=\"card\">\n      //   <smart-button>/* Card button */</smart-button>\n      //   <section class=\"card-panel\">\n      //     <smart-button>/* Rename button */</smart-button>\n      //     <smart-button>/* Delete button */</smart-button>\n      //   </section>\n      // </div>\n      // and return DOM element\n      var cardNode = document.createElement('div');\n      cardNode.classList.add('card');\n\n      var cardButton = document.createElement('smart-button');\n      cardButton.setAttribute('type', 'app-button');\n      cardButton.className = 'app-button';\n      cardButton.dataset.cardId = card.cardId;\n\n      var cardPanel = document.createElement('section');\n      cardPanel.className = 'card-panel';\n\n      var renameButton = document.createElement('smart-button');\n      renameButton.dataset.icon = 'rename';\n      renameButton.classList.add('rename-btn');\n\n      var deleteButton = document.createElement('smart-button');\n      deleteButton.dataset.icon = 'delete';\n      deleteButton.classList.add('delete-btn');\n\n      cardPanel.appendChild(renameButton);\n      cardPanel.appendChild(deleteButton);\n\n      cardNode.appendChild(cardButton);\n      cardNode.appendChild(cardPanel);\n\n      // XXX: will support Folder and other type of Card in the future\n      // for now, we only create card element for Application and Deck\n      if (card instanceof Application) {\n        if (card.group === 'tv') {\n          cardButton.classList.add('tv-channel');\n          cardButton.dataset.icon = 'tv';\n          cardButton.setAttribute('app-type', 'tv');\n        } else {\n          cardButton.setAttribute('app-type', 'app');\n          this._fillCardIcon(cardButton, card);\n        }\n      } else if (card instanceof Deck) {\n        cardButton.setAttribute('app-type', 'deck');\n        if (card.group === 'website') {\n          this._fillCardIcon(cardButton, card);\n        } else {\n          this._createWave(cardButton, card);\n        }\n      } else if (card instanceof Folder) {\n        cardButton.setAttribute('app-type', 'folder');\n        cardButton.dataset.icon = 'folder';\n      }\n\n      // For smart-button, we put card name in pseudo-element :after. However,\n      // we need to localize card name and l10n library do not support\n      // localizing element with children elements.\n      // Instead of using :after, we create a 'span' element under smart-button\n      // and put card name in it.\n      var nameSpan = document.createElement('span');\n      nameSpan.classList.add('name');\n      this._localizeCardName(nameSpan, card);\n      cardButton.appendChild(nameSpan);\n\n      return cardNode;\n    },\n\n    _createCardList: function(cardList) {\n      cardList.forEach(function(card) {\n        this.cardListElem.appendChild(this.createCardNode(card));\n      }.bind(this));\n    },\n\n    onMove: function(key) {\n      if (!this.isNavigable || this.edit.onMove(key)) {\n        return;\n      }\n\n      var focus = this.spatialNavigator.getFocusedElement();\n\n      if (!(focus.CLASS_NAME == 'XScrollable' && focus.move(key))) {\n        this.spatialNavigator.move(key);\n      }\n    },\n\n    onEnter: function() {\n      if (!this.isNavigable || this.edit.onEnter()) {\n        return;\n      }\n\n      var focusElem = this.focusElem;\n\n      if (focusElem === this.settingsButton) {\n        this.openSettings();\n      } else if (focusElem === this.editButton) {\n        this.cleanFolderScrollable();\n        this.edit.toggleEditMode();\n        // XXX: Reset card filter when entering edit mode\n        this.filterManager.resetFilter();\n      } else if (focusElem &&\n          this.filterElementIds.indexOf(focusElem.id) > -1) {\n        this.cleanFolderScrollable();\n      } else {\n        // Current focus is on a card\n        var cardId = focusElem.dataset.cardId;\n        var card;\n        if (this.focusScrollable === this.folderScrollable) {\n          card = this._folderCard.findCard({cardId: cardId});\n        } else {\n          card = this.cardManager.findCardFromCardList({cardId: cardId});\n        }\n\n        if (card) {\n          card.launch();\n        }\n      }\n    },\n\n    onSearchBarShown: function() {\n      var hideSearchBar = function() {\n        document.removeEventListener('visibilitychange', hideSearchBar);\n        this.searchBar.hide();\n      }.bind(this);\n      document.addEventListener('visibilitychange', hideSearchBar);\n\n      var activity = new MozActivity({\n        name: 'search',\n        data: { keyword: '' }\n      });\n\n      activity.onerror = hideSearchBar;\n    },\n\n    onSearchBarHidden: function() {\n      this.searchButton.classList.remove('hidden');\n    },\n\n    _getNavigateElements: function() {\n      var elements = [];\n      this.navigableIds.forEach(function(id) {\n        var elem = document.getElementById(id);\n        if (elem) {\n          elements.push(elem);\n        }\n      });\n      this.navigableClasses.forEach(function(className) {\n        var elems = document.getElementsByClassName(className);\n        if (elems.length) {\n          // Change HTMLCollection to array before concatenating\n          elements = elements.concat(Array.prototype.slice.call(elems));\n        }\n      });\n      elements = elements.concat(this.navigableScrollable);\n      return elements;\n    },\n\n    handleFocus: function(elem) {\n      if (elem.CLASS_NAME == 'XScrollable') {\n        this._focusScrollable = elem;\n        elem.focus();\n        this.checkFocusedGroup();\n      } else if (elem.nodeName) {\n        if (this._focus) {\n          this._focus.blur();\n        }\n\n        switch(elem.nodeName.toLowerCase()) {\n          case 'menu-group':\n            this.handleFocusMenuGroup(elem);\n            break;\n          default:\n            elem.focus();\n            this._focus = elem;\n            this._focusScrollable = undefined;\n            this.checkFocusedGroup(elem);\n            break;\n        }\n      } else {\n        this._focusScrollable = undefined;\n      }\n    },\n\n    handleUnfocus: function(elem, nodeElem) {\n      if(elem.CLASS_NAME == 'XScrollable') {\n        this.handleCardUnfocus(\n                elem, elem.currentItem, elem.getNodeFromItem(elem.currentItem));\n      }\n    },\n\n    checkFocusedGroup: function(elem) {\n      if (!this._focusedGroup) {\n        return;\n      }\n\n      // close the focused group when we move focus out of this group.\n      if (!elem || !this._focusedGroup.contains(elem)) {\n        this._focusedGroup.close();\n        this._focusedGroup = null;\n      }\n    },\n\n    handleFocusMenuGroup: function(menuGroup) {\n      var self = this;\n      menuGroup.once('opened', function() {\n        self.spatialNavigator.remove(menuGroup);\n        var childElement = menuGroup.firstElementChild;\n        var firstFocusable = null;\n        while(childElement) {\n          switch(childElement.nodeName.toLowerCase()) {\n            case 'style':\n            case 'script':\n              break;\n            default:\n              firstFocusable = firstFocusable || childElement;\n              self.spatialNavigator.add(childElement);\n          }\n          childElement = childElement.nextElementSibling;\n        }\n        if (firstFocusable) {\n          self.spatialNavigator.focus(firstFocusable);\n        }\n      });\n      menuGroup.once('will-close', function() {\n        // Clear all opened event listener because we won't have it if opened is\n        // not fired and the group is trying to close it self.\n        menuGroup.off('opened');\n        self.spatialNavigator.add(menuGroup);\n        var childElement = menuGroup.firstElementChild;\n        while(childElement) {\n          switch(childElement.nodeName.toLowerCase()) {\n            case 'style':\n            case 'script':\n              break;\n            default:\n              self.spatialNavigator.remove(childElement);\n          }\n          childElement = childElement.nextElementSibling;\n        }\n      });\n      this.checkFocusedGroup(menuGroup);\n      this._focusedGroup = menuGroup;\n      menuGroup.open();\n    },\n\n    handleCardFocus: function(scrollable, itemElem, nodeElem) {\n      this._focus = itemElem;\n\n      if (this.edit.mode === 'edit') {\n        this.edit.handleCardFocus(scrollable, itemElem, nodeElem);\n      }\n      itemElem.focus();\n      nodeElem.classList.add('focused');\n      if(scrollable === this.cardScrollable && this._folderCard &&\n                        itemElem.dataset.cardId !== this._folderCard.cardId &&\n                        !this.cardScrollable.isHovering) {\n        this.cleanFolderScrollable();\n      }\n    },\n\n    cleanFolderScrollable: function(doNotChangeFocus) {\n      if (this._focusScrollable === this.folderScrollable &&\n          !doNotChangeFocus) {\n        this.spatialNavigator.focus(this.cardScrollable);\n      }\n      this.spatialNavigator.remove(this.folderScrollable);\n      this.folderScrollable.clean();\n      this._folderCard = undefined;\n      this.edit.isFolderReady = false;\n      this.cardScrollable.setColspanOnFocus(0);\n    },\n\n    handleCardUnfocus: function(scrollable, itemElem, nodeElem) {\n      // Fix null error when the last card in a folder is removed.\n      if (nodeElem) {\n        nodeElem.classList.remove('focused');\n      }\n    },\n\n    handleCardUnhover: function(scrollable, itemElem, nodeElem) {\n      this.cleanFolderScrollable();\n    },\n\n    determineFolderExpand: function(evt) {\n      // Folder expansion is performed on only when user moves cursor onto a\n      // folder or hover a folder in edit mode and it finished its focus\n      // transition.\n      if (this.focusScrollable === this.cardScrollable &&\n        evt.originalTarget.classList.contains('app-button') &&\n        (!this._folderCard ||\n          this._folderCard.cardId !== evt.originalTarget.dataset.cardId) &&\n        (evt.originalTarget.classList.contains('focused') &&\n          // Listen to 'outline-width' rather than 'transform' here since it\n          // also applies to edit mode when user moves from panel button back\n          // to card.\n          evt.propertyName === 'outline-width' &&\n          document.getElementById('main-section').dataset.mode !== 'arrange' ||\n          // Folder needs to be expanded when hovered as well.\n          evt.originalTarget.classList.contains('hovered'))) {\n        this.buildFolderList(evt.originalTarget);\n      }\n    },\n\n    buildFolderList: function(target) {\n      var cardId = target.dataset.cardId;\n      var card = this.cardManager.findCardFromCardList({cardId: cardId});\n      if (!(card instanceof Folder)) {\n        return;\n      }\n\n      this._folderCard = card;\n      var folderList = this._folderCard.getCardList();\n\n      if (folderList.length === 0) {\n        this.edit.isFolderReady = true;\n        // Needs to disable the folder-list animation right away to\n        // prevent it from affecting the new-card into folder animation.\n        this.folderListElem.style.transition = 'none';\n        return;\n      }\n\n      // Build folder list\n      folderList.forEach(function(card) {\n        this.folderScrollable.addNode(this.createCardNode(card));\n      }, this);\n\n      var isFirstFrame = true;\n      var initFolderAnimation = function() {\n        if (isFirstFrame) {\n          isFirstFrame = false;\n          // At first frame, we call setReferenceElement to move folder list\n          // right under folder card. Transition should be replaced by 'none'\n          // since we don't need to show this process as animation to user.\n          this.folderListElem.style.transition = 'none';\n          this.folderScrollable.realignToReferenceElement();\n          this.skipFolderBubble = Animations.doBubbleAnimation(\n                        this.folderListElem, '.app-button', 100, function() {\n              this.spatialNavigator.add(this.folderScrollable);\n              this.edit.isFolderReady = true;\n              this.skipFolderBubble = undefined;\n            }.bind(this));\n\n          window.requestAnimationFrame(initFolderAnimation);\n        } else {\n          // 2nd frame, recover original transition.\n          this.folderListElem.style.transition = '';\n        }\n      }.bind(this);\n      window.requestAnimationFrame(initFolderAnimation);\n    },\n\n    openSettings: function() {\n      /* jshint nonew: false */\n      new MozActivity({\n        name: 'configure',\n        data: {}\n      });\n    },\n\n    updateClock: function() {\n      var now = new Date();\n      var _ = navigator.mozL10n.get;\n      var use12Hour = window.navigator.mozHour12;\n\n      var f = new navigator.mozL10n.DateTimeFormat();\n\n      var timeFormat = use12Hour ? _('shortTimeFormat12') :\n                                   _('shortTimeFormat24');\n      // remove AM/PM and we use our owned style to show it.\n      timeFormat = timeFormat.replace('%p', '').trim();\n      var formatted = f.localeFormat(now, timeFormat);\n\n      this.timeElem.innerHTML = formatted;\n      this.timeElem.dataset.ampm = use12Hour ? f.localeFormat(now, '%p') : '';\n    },\n\n    restartClock: function() {\n      navigator.mozL10n.ready((function() {\n        // restart clcok\n        this.clock.stop();\n        this.clock.start(this.updateClock.bind(this));\n      }).bind(this));\n    },\n\n    get focusElem() {\n      return this._focus;\n    },\n\n    get focusScrollable() {\n      return this._focusScrollable;\n    }\n  };\n\n  exports.Home = Home;\n}(window));\n\n"]}